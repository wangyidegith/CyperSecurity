补充：
（一）Windows家庭版本（不区分家庭版和专业版）版本的发展历史：
早期版本（Windows 1.0至3.x）：1985年发布的Windows 1.0是一个图形用户界面，后续版本逐渐改进了界面和功能。

Windows 95（1995年）：引入了全新的用户界面，支持即插即用，成为家用电脑的主流操作系统。

Windows NT系列：自1993年开始，针对企业和高性能计算，提供更强的稳定性和安全性。也用于服务器。

Windows XP（2001年）：结合了Windows 2000的稳定性和Windows 95的用户友好性，广受欢迎。

Windows Vista（2007年）：引入了新的界面和安全特性，但因性能问题受到批评。

Windows 7（2009年）：改进了性能和用户体验，获得了广泛的好评。

Windows 8/8.1（2012/2013年）：引入了触摸友好的界面，尝试结合桌面和移动设备体验，但反响不佳。

Windows 10（2015年）：回归传统桌面风格，同时加入了许多现代功能，推出“作为服务”的更新模式。

Windows 11（2021年）：引入了全新的界面设计，改进了窗口管理和多任务处理。



（二）Windows企业版本（服务器版本）的发展历史：
Windows NT 3.1 (1993)：
第一个Windows NT版本，主要面向企业市场，支持多用户和多任务处理。

Windows NT 3.5 (1994)：
改进了网络性能和支持，更好地兼容Windows 95。

Windows NT 4.0 (1996)：
引入了Windows 95风格的用户界面，提升了可用性，增强了网络功能。

Windows 2000 Server (2000)：
引入Active Directory、改进的安全性和可靠性，支持更大规模的网络。

Windows Server 2003 (2003)：
增强了性能、安全性和管理功能，推出了多个版本（Standard、Enterprise、Web等）。

Windows Server 2008 (2008)：
引入了Server Core和Hyper-V虚拟化技术，增强了管理工具。

Windows Server 2008 R2 (2009)：
主要改进了虚拟化功能和支持64位处理器。

Windows Server 2012 (2012)：
引入了全新的界面和改进的虚拟化功能，推出了Server Manager。

Windows Server 2012 R2 (2013)：
增强了存储、网络和虚拟化功能，引入了新的管理工具。

Windows Server 2016 (2016)：
引入了Nano Server、Windows Container和增强的安全特性。

Windows Server 2019 (2018)：
增强了混合云集成、存储和计算功能。

Windows Server 2022 (2021)：
引入了更好的安全性、混合云功能以及对Kubernetes的支持。



（三）一些缩写解释：
Windows NT：
NT代表New Technology。这个名字反映了微软为其操作系统引入的许多新技术，特别是其设计用于企业环境的稳定性和安全性。

Windows Server 2003 R2：
R2代表Release 2。这是Windows Server 2003的一个更新版本，提供了额外的功能和改进，旨在增强服务器的性能和管理能力。

Windows XP：
XP代表Experience。这个名字强调了用户的整体使用体验，旨在提供更友好和直观的用户界面。

Windows Vista：
Vista是一个西班牙语单词，意为“景观”或“视野”。这个名称传达了该操作系统的视觉设计和新功能带来的全新体验。







零 基本概念
（零）系统快照。



（一）文件、文件夹、目录文件、盘符、文件目录
1 文件
2 文件夹：我们一般说的目录。
3 目录文件：这才是真正的目录，一个1T的硬盘为什么不能存储1T信息是因为还需要存目录啊。
4 盘符：比如你看到的C:、D:等（C盘一般是系统盘），代表了一个盘，所谓盘不是硬件概念而是软件概念，用户和OS可以自由划分，这一点也是和Linux文件系统的根本不同，Linux不分盘。
注意：
（1）不区分大小写；
（2）必须带有:；
5 文件目录：存放一个文件在磁盘中的元数据。



（二）文件拷贝速度的影响因素
1 固态比机械快。
2 SATA比USB快。
3 不同磁盘间比同一块磁盘上快。



（三）对于整个Windows系统的认识
Linux系统就是一个/，Windows就是一个“此电脑”，Linux是一切皆文件，而Windows是有一些管理工具，其中最底层的管理工具便是”计算机管理“。
你可以右键点击“此电脑”再点击管理，这个管理工具即计算机管理（3大部分8小部分），3指系统工具、磁盘管理、服务和应用程序（就是服务没有常见的APP），8该工具负责管理磁盘、服务（著名的WMI服务）、用户和用户组、共享文件夹、任务计划、事件查看器、查看性能、设备驱动（硬件）。
除此以外，在现代，任何一个面向非专业用户（即有界面的）的OS都有四大基本程序：
设置：比如Windows的设置（控制面板是以前的叫法现在也有所保留但是和设置差不多，实际上是C:\Windows\System32\control.exe，设置是高级的“计算机管理”），比如华为nova7的设置。
文件管理器：比如Windows的文件资源管理器（快捷键Win+e），比如华为nova7的文件管理，文件资源管理器的文件系统即“此电脑”（文件资源管理器有两个子核心功能：计算机管理和属性，其中属性是设置的系统的关于）。
应用商店：比如Windows的Microsoft Store，比如华为nova7的应用市场。
管家（主要负责安全）：比如Windows的安全中心，比如华为nova7的手机管家。
其中设置和文件管理器是必须的，应用商店和管家一般也会有，但是很多用户也会选择去下载安装其他的管家比如360、腾讯电脑管家等，而对于应用商店，在手机上我一般会使用应用商店下载尤其是苹果手机你不用还不行（这个其实挺增强安全性的，除非ipa被签名要不都不能安），但是在Windows上，Microsoft Store总是将程序安装到C盘，而我还不知道该怎么改，随便吧，反正我喜欢在官网上下载安装包然后自己安装。



（四）文件删除
1 计算机的删除是什么？不管在什么操作系统上，文件的删除都是标记删除即不覆盖就还是没删只是索引删了。
2 在Windows下，你用del就和rm一样，但是你正常用鼠标删都是放到回收站里去了。
3 格式化：
概念：计算机存储介质（如硬盘、SSD、U盘等）进行初始化的过程，说白了就是重置，所以之前的文件肯定丢了。
操作：只能对盘进行格式化，不能对C盘进行格式化。
（1）快速格式化：这种格式化方式仅仅重建了文件系统的结构（如文件分配表），而没有彻底擦除数据。
（2）完全格式化：会写入随机数据或0进行覆盖，是彻底的删除。



（五）文件查询
一般的图形界面OS都会提供搜索框，Windows的话搜索框一般在左下角，你也可以在文件资源管理器里进行范围可控的查询。



（六）文件属性（Windows的文件属性比Linux更丰富）
1 文件大小：有三个地方可以看见大小：
（1）属性框的常规-大小。
（2）属性框的常规-占用空间，你大概率会看到一个4096B的大小，显然这不是真实的文件大小，它是一个簇的大小。所谓簇就是存储单元，一个簇一般最小是4096（格式化里的分配单元大小选项可见和改该值）。簇的涉及是为了方便磁盘IO。
（3）在文件展示列表里也能看到文件大小，但是如果文件很小就会显示为1K，大的也是显示整数。
2 也有文件类型、创建修改访问时间等常见属性。
3 Windows文件独有的一些属性：
（1）只读；
（2）隐藏 == Linux的.file
（3）压缩；
（4）加密（没搞明白，不应该有密码吗？）。



（七）文件修改：
（1）在Windows下一般用记事本了，远没有vim那么复杂.
（2）文件修改后，当你保存时，可能会建立新的索引和区域。



（八）文件资源管理器的界面：这个一般都很熟悉了，需要注意有文件、主页、共享、查看、搜索五个子功能，在查看里可以选择是否隐藏文件、是否隐藏后缀名等。



（九）如何执行程序（后缀名为exe）？双击即运行，也可以像Linux那样通过路径执行pe。当然非C/C++语言的程序都是需要解释器或者虚拟环境的。



（十）文件类型（看后缀，对于用户而言后缀有标识类型作用，但是注意有的后缀已经被OS所认识，比如txt、html等，我们讲的类型就是被OS认识的而不是用户自定义的）
1 文档：txt，txt是最标准的纯正的文档，除此以外，html、htm、pdf、md、xls、xlsx、doc、docx、ppt、pptx这都是文档（带x的更现代），但是他们带有特殊格式，因而很多时候也把这些叫文档格式。
2 程序：exe == Linux下的elf。
3 快捷方式 == Linux下的软链接，你还可以修改快捷方式的图标（ICO文件是一种图像文件格式，通常用于存储图标图像），挺好玩的。
4 图片文件：最原始的raw（这个很大，就是从胶卷拿到的，不能用），实际上所有的我们看到图片类型都是经过压缩的。
5 dll == Linux so
6 各种xml啊、dat啊等等。



（十一）重要文件夹：
1 Program Files：存储64位程序，这就是为什么默认安装在这。
2 Program Files(32)：存储32位程序。
3 Windows：Windows操作系统就在这。



（十二）软件安装和卸载（Windows可没有Linux的universe）
1 应用商店或者官网，不建议去乱七八糟的地方下。
2 有三种类型：
（1）有安装程序；
（2）没有安装程序；
（3）破解的绿色软件（重点是去哪找？）。
3 注意对比hash（其实大多数非专业用户都不会搞这个，还是那句话，人是最大的漏洞）。
4 卸载：两种方法。



接下来要讲的有的是Windows专业版才有的功能。
（十三）修改密码
1 登录后修改密码：
net user <user> <passwd>
or
在“计算机管理”的用户下面修改密码。
2 忘记密码如何修改密码：使用pe系统（原理是修改了SAM文件（C:\Windows\System32\config\SAM），非pe系统不能访问该文件。这里多一嘴：任何OS都会将用户密码的哈希值放到一个文件里保存（Linux是/etc/shadow），修改密码的本质都是修改了这个文件里的哈希值）。
3 如何防止别人使用pe修改你的密码？设置BIOS密码并关掉U盘启动项。



（十四）开机自启（后门持久化）
1 很多软件在安装的时候也会让你选择是否开机自启，如果你忽略了这一点也没关系，可以在设置-应用-启动里选择让这些应用程序是否开机自启。
2 如何添加某些程序为开机自启？
（1）将exe放到在C:\Users\wydeg\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup下（通过Win+r打开运行，输入shell:startup可以定位到该文件夹）。
（2）设置服务并修改注册表（这个方法不管是Linux还是Windows都是后门持久化的主要方法，区别在于Linux没有注册表而是/etc）：这是最隐蔽的方式，后渗透常用。
（3）计划任务 == Linux的cron



（十五）文件共享
1 通过ICP提供的工具（qq、wechat、网盘等），但是qq微信只能传小文件且不能传文件夹，网盘也不能传太大的文件，而且关键是慢啊，当然你可以选择分块压缩（WinRAR）后传输。
2 物理工具：U盘（最安全的方式）。
3 Windows的文件共享机制（详见net命令的SMB协议）。
SMB那一块说net use，这里说基本的图形界面操作：
（1）如何将一个文件夹设置为共享文件夹？右键、点击属性、点击共享、选择（没有也可以添加）要共享的用户、点击共享。
（2）有权访问该共享文件的用户如何访问？Win+r打开运行框，输入\\共享文件夹在的主机的主机名或者IP地址\共享文件夹名，这个过程对应了net use的过程。
（3）注意查看：控制面板\网络和 Internet\网络和共享中心\高级共享设置。这里面有一些控制参数，比如专用网络和公用网络下的“是否允许主机发现”（默认是）和“是否允许文件夹共享”（默认是），所有网络的“是否允许共用文件夹共享”（默认否）、“文件共享连接采用的加密方式”（默认128位）、“是否开启密码”（默认开启）。
4 第三方共享软件：feiq（飞秋）



（十六）Windows的网络设置
1 设置-网络和Internet（在其中你可以设置网络的热点和代理）-高级网络设置（有三个主要功能：其中最主要的就是网络和共享中心，更改适配器选项是网络和共享中心的一个核心子功能（查看和配置各张网卡），疑难解答）-更改高级共享是SMB协议的配置文件。
2 通过“高级共享设置”，可以看出Windows将网络分为两类：专用、共用（来宾）。但是注意这不是强制规定而是用户自由选择，这个很扯淡，非专业用户哪懂这啊。一般我们认为家庭网络可设置为专用网络、咖啡厅那种网络设置为公用。



（十七）远控
1 todesk、向日葵等第三方反向代理工具。
2 远程桌面连接（家庭版可以连别人但不能被被人连）：控制端打开该工具（Win+r，mstsc），输入被控端的IP地址、用户名、密码（提高minikatz获取），连接。被控端被要求打开3389监听（此电脑-属性-远程桌面-开启）并关掉防火墙。



（十八）注册表（Win + r，regedit）
1 概念：Windows的核心数据库（Windows叫登录档案），记录了很多软硬件的配置参数，相当于Linux的/etc。
2 项、子项、值。
3 注册表中的配置信息和各个软件的设置中的配置信息一一对应，你改了设置注册表会变，你改了注册表设置也会变，但是注意注册表是优先级最高的配置文件。
4 应用：软件破解、开机自启
开机自启在下面的地方修改：
HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Run（系统范围的启动项）
HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run（当前用户的启动项）



（十九）组策略
1 注册表编辑的易用版。
2 这个工具本身在注册表里也有配置文件，位于：
HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies（系统范围的启动项）
HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Policies（当前用户的启动项）
3 应用场景：禁止用户使用某些app（注意要添加进程名）等。



（二十）服务（计算机管理里面可以查看并设置已知服务）
1 概念：区别于客户端程序，服务不一定是指httpd那样的网络服务，本地服务也是服务啊，比如打印机服务程序、更新服务程序等。
2 如何添加新的服务？
（1）sc create 服务名称 binPath= 可执行文件路径
（2）设置开机自启：启动不了，手动也启动不了，一般会报一个“1053：服务没有及时响应启动或控制请求”，这是因为该exe缺少必要的代码。
如何解决？



（二十一）计划任务（在计算机管理） == Linux cron



（二十二）用户和用户组：详见net user 命令。



（二十三）终端代理：就是在本机上起代理，可以使用set http_proxy这种命令设置。



（二十四）凭据（凭证）：用户密码是，票也是。一般操作使用cmdkey，票可用klist查看。



（二十五）Windows的命令不像Linux一样整顿，Windows有一些超级命令（能干很多事），比如wmic、net（netsh），query。



（二十六）UNC：UNC（Universal Naming Convention）使用格式为：\\服务器名\共享名，允许用户通过网络访问共享资源。它避免了使用驱动器字母，支持跨网络访问。在域渗透中你会多次看到这种形式。



（二十七）Windows的文件路径不区分大小写。







一 基本命令
cls == clear
set == export
systeminfo == uname
query：查一切







二 文件管理（分磁盘的，比如C盘、D盘等，Linux是一个盘）
1 磁盘检查和修复
sfc == fsck（既检查又修复，sfc可修复）
chkdsk == fsck

2 基本操作
（1）创建文件：
echo 这是一些文本 > 文件名.txt
type nul > 空文件.txt
copy nul 空文件.txt
fsutil file createnew 文件名.txt 1024
（PS）New-Item -Path . -Name "文件名.txt" -ItemType "File"
（2）其他：
dir == ls
cd
mkdir
rmdir：
如何强制删除一个目录（重要命令，== rm -rf "文件夹路径"）：rmdir /s /q "文件夹路径"

del == rm
copy == cp
xcopy == cp -r
move == mv
findstr /s == grep -r
type == cat   // Linux的type命令用于显示命令的路径







三 进程管理
start == 路径
start /b == ./ & 
tasklist == ps
taskkill == kill







四 服务管理（sc== systemctl == service）
sc query <服务名>
sc start <服务名>
sc stop <服务名>
sc config <服务名> start=<启动类型，可以是auto、demand（手动）、disabled>
sc delete <服务名>
sc qc <服务名>：查询服务配置
sc create 服务名称 binPath= 可执行文件路径   // 这个命令很重要，用于执行一个exe
sc control 服务名称 控制代码







五 证书：certutil







六 网络（Windows命令关于网络安全的主要命令）
（一）基本命令
1 接口层
ipconfig == ifconfig == ip l
arp
2 网络层
ping
tracert == traceroute
route == ip r
3 传输层
netstat -an | findstr "port"
4 应用层（三大协议http、dns、ssh）
wget：得powershell
ssh（scp）
nslookup



（二）中级命令：net命令（一般需要Administrator（==Linux的root），但是也不是所有的命令都需要root）
0 概念：
这是一个类似于Linux ip命令一样的复杂命令（即非单一功能而有子功能的命令，这种命令一般叫它工具，实际上所有命令都是工具），
但是net和ip命令看上去都是关于网络的，
但是net命令还真不是主要关于网络的，
但Linux没有这个命令，
该命令是一个集成网络管理（共享文件夹（SMB协议））、用户管理（对于Linux的adduser等命令）、服务管理（net也有sc的功能）的命令。

下面介绍三大功能：

1 文件共享
（1）本地操作
net share：查看当前被共享的文件。默认会有三类共享文件：盘下一级目录（共享文件名叫C$、D$等）、IPC$、ADMIN$，其中IPC$就是著名的IPC横移所使用的共享文件，你会发现这些默认的共享文件的名字的结尾都是$（这可用作区分默认共享文件和自定义共享文件夹）。
net session：
net file：
（2）远程操作（net use，仅执行net use命令可以查看当前主机发起了哪些SMB连接）
注意：”\\目标主机名或IP地址\共享名“这个东西你得提前知道，比如一个文件夹在桌面，但是它的网络共享路径可不一定在是\\目标主机名\桌面的路径\共享文件夹，它的路径你得具体去属性里看（文件名一般不会变）。

第零种方式（非命令行的方式）：
直接在文件资源管理器里的导航栏输入：\\目标主机名或IP地址\共享名
回车
输入目标机器的用户名和密码
进入目标机器的共享文件夹（在本地的在”网络“里）

第一种方式（使用这种方式输入一次用户名密码后就可以访问目标机器上的任何共享文件夹）：
net    use    \\目标主机名或IP地址\共享名    /user:用户名 密码
然后就可以像在操作本地文件操作远程机器上的共享文件了，比如：dir \\192.168.1.131\c$，唯一需要注意的是这个文件的路径是“\\目标主机名或者IP地址\共享文件名”（这叫UNC）。
上传下载用copy

第二种方式：
net    use    远程盘映射到本地的位置 （随便起一个没有的盘名比如“X:”）   \\目标主机名或者IP地址\共享名    /user:用户名    密码
然后在命令行输入x:（不要cd x:），回车，就可以进入这个共享文件夹了。
相比于第一种方式这种方式可以实现完全的本地操作。


2 用户管理：
（1）用户（还有/comment）
查询所有用户（不一定上线而是所有注册过的用户）：net user
增：net user [用户名] [密码] /add
删：net user [用户名] /delete
改：net user [用户名] [新密码]
查（能看到很多，比如一个用户是否启用）：net user [用户名]
如何启用一个用户：net user <username> /active
如何禁用一个账户：net user <username> /active:no
查看所有域账户（账户的类型？）：net user /domain
（2）用户组
组级别：
增：net localgroup [组名] /add
删：net localgroup [组名] /delete
查：net localgroup
组用户级别：
增：net localgroup [组名] [用户名] /add
删：net localgroup [组名] [用户名] /delete
查：net localgroup [组名]

3 服务控制：
（1）显示当前运行的服务列表
net start
（2）启动指定的服务
net start <服务名>
（3）停止指定的服务
net stop <服务名>

4 域渗透相关命令汇总：
（1）用于管理域组（在域环境中）：
net group：查看该域管理的所有主机名：net group "domain computers" /domain



（三）高级命令：netsh（需要Administrator（==Linux的root））
1 == Linux下的ip套件（比ip更丰富，甚至可以做端口转发、可以操作防火墙）
2 一级功能（和ip一样是个复杂命令）
（1）Interface: 查看和配置网络接口的设置,如 IP 地址、DNS 服务器、DHCP 等。
查看网络接口状态和配置:
show interface - 列出所有网络接口。
show interface <name> - 显示指定网络接口的详细信息。
配置 IP 地址:
ip set address name="<interface_name>" source=static addr=<IP_address> mask=<subnet_mask> - 设置静态 IP 地址。
ip set address name="<interface_name>" source=dhcp - 启用 DHCP 自动获取 IP 地址。
配置 DNS 服务器:
dns set server name="<interface_name>" source=static address=<DNS_server_IP> - 设置静态 DNS 服务器。
dns set server name="<interface_name>" source=dhcp - 使用 DHCP 获取 DNS 服务器地址。
配置 DHCP 选项:
dhcp set options name="<interface_name>" <option_id> <option_value> - 设置 DHCP 选项。
配置 MTU 值:
interface set interface name="<interface_name>" mtu=<mtu_value> - 设置 MTU 值。
管理网络连接:
interface set interface name="<interface_name>" admin-mode=<enabled|disabled> - 启用或禁用网络接口。
interface set interface name="<interface_name>" media-type=<media_type> - 设置网络接口的媒体类型。
管理 VLAN:
vlan add name="<interface_name>" tagid=<vlan_id> - 添加 VLAN 接口。
vlan delete name="<interface_name>" tagid=<vlan_id> - 删除 VLAN 接口。
管理 Bond 接口（链路聚合或网卡绑定,是一种将多个网卡逻辑组合成一个虚拟网卡的技术）:
bond add name="<bond_name>" [member="<member_interface1>,<member_interface2>"] [mode=<mode>] - 创建 Bond 接口。
bond delete name="<bond_name>" - 删除 Bond 接口。
管理 IPSEC 策略:
ipsec static add policy name="<policy_name>" - 添加 IPSEC 策略。
ipsec static delete policy name="<policy_name>" - 删除 IPSEC 策略。
管理 Teaming 接口（与Bond类似）:
team add name="<team_name>" [member="<member_interface1>,<member_interface2>"] [loadbalancing=<mode>] - 创建 Teaming 接口。
team delete name="<team_name>" - 删除 Teaming 接口。
管理 Winsock 设置:
winsock reset [catalog] [input] - 重置 Winsock 目录和输入缓存。
管理 NetBIOS 设置（这个技术现在已经几乎不用了）:
netbios set interface name="<interface_name>" [scope=<scope_id>] [nodetype=<node_type>] - 配置 NetBIOS 设置。
端口映射：
netsh interface portproxy add v4tov4 listenport=<local_port> connectaddress=<remote_ip> connectport=<remote_port>
（2）Advfirewall: 管理和配置 Windows 高级防火墙的设置。
开启防火墙：netsh advfirewall set allprofiles state on
关闭防火墙：netsh advfirewall set allprofiles state off
（3）Winsock: 管理和配置 Windows 套接字层(Winsock)的设置。
（4）DHCP: 管理和配置 DHCP 服务器的设置。
（5）DNS: 管理和配置 DNS 客户端的设置。
（6）NetSh: 管理和配置 netsh 命令本身的设置和默认功能。
（7）Routing: 管理和配置路由表和静态路由。
（8）RPC: 管理和配置远程过程调用(RPC)服务的设置。
（9）Winhttp: 管理和配置 Windows HTTP Services (WinHTTP) 的设置。
（10）Diag: 执行网络诊断和测试。
3 在内网渗透上的主要用法：
（1）端口映射：
netsh interface portproxy add v4tov4 listenport=<local_port> connectaddress=<remote_ip> connectport=<remote_port>
（2）关闭防火墙：
netsh advfirewall set allprofiles state off