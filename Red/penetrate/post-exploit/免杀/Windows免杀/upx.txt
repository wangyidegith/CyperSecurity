一 注意
1 经 UPX 压缩后的可执行文件可以在没有 UPX 程序的主机上运行。

2 压缩完很明显小了。

3 只能用于pe文件和elf文件（但是测试存在问题）。







二 用法
1 基本：upx 任何可执行文件

2 对免杀用不上：upx -d 已加壳的可执行文件

3 保留原始文件：upx -k 任何可执行文件







三 与msf合作
（一）一个错误：upx不能压缩-x的exe尽可以压缩普通病毒，压缩-x的exe会发生这个错误：upx: putty_x.exe: CantPackException: section size problem。
因而，要不在msfvenom之前就压缩，要不就不用-x。



下面统一采用先upx压缩再msfvenom（这种方式显而易见会让源程序功能不能正确运行，木马表现的和普通病毒一样（无窗口不能删，最low的就是有窗口的现在的msf的主流payload已经没有这种low比了，但是不能删不太好，set生成的hta是能删的（因为它采用了powershell动态库注入进行了迁移，所以想要能删就要进行迁移或者持久化））。
（二）x64：能回连。
upx + Hyperion + -x -e：Hyperion + -x -e经测试就已经很慢了，再加上upx更慢而且回连一下就死，看来upx和Hyperion在一起并不合适。

（三）x86：练一下就死。