方法一：设置开机自启服务
（一）Linux
1 sudo vim /etc/systemd/system/your_program.service
```
[Unit]
Description=Your Program   // 请修改
After=network.target
[Service]
ExecStart=/path/to/your-program   // 请修改
Restart=always
User=your-username   // 请修改
[Install]
WantedBy=multi-user.target
```

2 sudo systemctl enable your-program.service



（二）Windows
注：需要管理员权限

1 sc命令
sc query <服务名>
sc start <服务名>
sc stop <服务名>
sc config <服务名> start=<启动类型，可以是auto、demand（手动）、disabled>
sc delete <服务名>
sc qc <服务名>：查询服务配置
sc create 服务名称 binPath= 可执行文件路径   // 这个命令很重要，用于执行一个exe
sc control 服务名称 控制代码

2 配置一个开机自启的服务：sc create "<新服务名>" binPath= "<可执行文件路径>" start= auto
注：参数值后面需要有空格，例如 start= auto 中的 start= 和 auto 之间必须有空格。
比如：sc create "MyService" binPath= "C:\path\to\my_service.exe" start= auto








方法二：任务计划
（一）Linux（详见《Linux命令》crontab）
1 crontab -e

2 @reboot /path/to/your-program



（二）Windows：schtasks /create /tn "任务名称" /tr "任务运行的程序或脚本" /sc "调度频率" /st "开始时间"
注：需要管理员权限。

1 调度频率
（1）一次性 (once)：
任务仅执行一次。
示例：/sc once
（2）每日 (daily)：
任务每天执行一次。
示例：/sc daily
（3）每周 (weekly)：
任务每周执行一次，可以指定具体的星期几。
示例：/sc weekly /d MON（每周一）
（4）每月 (monthly)：
任务每月执行一次，可以指定特定的日期或特定的星期几（如“每月第一个星期一”）。
示例：/sc monthly /d 15（每月15日）
（5）每小时 (hourly)：
任务每小时执行一次。
示例：/sc hourly
（6）每分钟 (minutely)：
任务每分钟执行一次。
示例：/sc minutely
（7）启动时 (onstart)：
任务在系统启动时执行。
示例：/sc onstart
（8）登录时 (onlogon)：
任务在用户登录时执行。
示例：/sc onlogon

2 开始时间：指任务的开始的时间，格式为 HH:mm（24小时制），比如/st 08:00。

3 几个例子：
（1）每周一八点执行一次：schtasks /create /tn "MyWeeklyTask" /tr "C:\path\to\example.bat" /sc weekly /d MON /st 08:00
（2）每个月第15天执行一次：schtasks /create /tn "MyMonthlyTask" /tr "C:\path\to\example.bat" /sc monthly /d 15 /st 08:00

4 删除任务：schtasks /delete /tn "任务名称"







方法三：将运行程序的指令写成一段代码通过动态库注入的方式注入到某些已经被系统开机自启的程序里，这是APT中后门持久化的常用方式。对应Windows的修改注册表，msf正是修改的注册表。